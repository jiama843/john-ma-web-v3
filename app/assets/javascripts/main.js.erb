

$(document).on("turbolinks:load", function(){
  var controller = $("body").data('controller');
  var action = $("body").data('action');

  if(controller == "main" && action == "index"){

    <% # Load introduction (Hi, I'm John) %>
    $('.oneshot_icon').slideDown(1618, function(){
      $('#introduction').fadeIn(1618, function(){
        $('#app_body').fadeIn(1618);
      });
    });

    <% # Fade out elements upon scroll %>
    $(window).scroll(function(){
      $(".container").each(function(){
        $(this).css("opacity", 1 - ($(this).offset().top - $(window).scrollTop()) / $(window).height()) * 1.2;
      });
    });

    <% # Redirect to link when project card is clicked %>
    $(".card").click(function() {
      window.location = $(this).find("a").attr("href"); 
      return false;
    });

    <% # Change colour of bulb %>
    var state = true;
    $( ".oneshot_icon" ).on("click", function() {
      if ( state ) {

        $('.oneshot_icon').fadeOut(500, function() {
          $('.oneshot_icon').css('background-image', 'url(<%= asset_path('oneshot_lightbulb_on.png')%>)');
          $('.oneshot_icon').fadeIn(500);
        });

        $(".navbar").css('background-image', 'url(<%= asset_path('oneshot_navbar.png')%>)').hide().fadeIn(1500);
        $(".navbar").css('color', 'yellow').hide().fadeIn(1500);

        $("#app").css('background-image', 'url(<%= asset_path('dark_bg.png')%>)').hide().fadeIn(1500);
        $("#app").css('color', 'yellow').hide().fadeIn(1500);

      } else {

        $('.oneshot_icon').fadeOut(500, function() {
          $('.oneshot_icon').css('background-image', 'url(<%= asset_path('oneshot_lightbulb_off.png')%>)');
          $('.oneshot_icon').fadeIn(500);
        });

        $(".navbar").css('background-image', 'none').hide().fadeIn(1500);
        $(".navbar").css('color', 'black').hide().fadeIn(1500);

        $("#app").css('background-image', 'none').hide().fadeIn(1500);
        $("#app").css('color', 'black').hide().fadeIn(1500);
        
      }
      state = !state;
    });
  }
});